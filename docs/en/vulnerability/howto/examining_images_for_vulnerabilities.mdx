---
weight: 15
---

# Examining Images for Vulnerabilities

Alauda Container Security for Kubernetes enables you to analyze container images for vulnerabilities using built-in or integrated scanners. The scanners inspect image layers, identify packages, and match them against vulnerability databases from sources like NVD, OSV, and OS-specific feeds.

> **Note:**
> Alauda Container Security includes two scanners: StackRox Scanner (default, based on Clair v2) and Scanner V4 (based on ClairCore, available since 4.4).

When vulnerabilities are detected, Alauda Container Security:
- Displays them in the **Vulnerability Management** view
- Ranks and highlights them for risk assessment
- Checks them against enabled [security policies](https://docs.redhat.com/en/documentation/alauda_container_security_for_kubernetes/4.7/html/operating/managing-security-policies#about-security-policies)

The scanner identifies installed components by inspecting specific files. If these files are missing, some vulnerabilities may not be detected. Required files include:

| Component Type | Required Files |
|---------------|---------------|
| Package managers | `/etc/alpine-release`; `/etc/lsb-release`; `/etc/os-release` or `/usr/lib/os-release`; `/etc/oracle-release`; `/etc/centos-release`; `/etc/redhat-release`; `/etc/system-release`; other similar files |
| Language-level dependencies | `package.json` (JavaScript); `dist-info`/`egg-info` (Python); `MANIFEST.MF` (Java JAR) |
| Application-level dependencies | `dotnet/shared/Microsoft.AspNetCore.App/`; `dotnet/shared/Microsoft.NETCore.App/` |

## Scanner V4 Overview

Scanner V4, available since 4.4, enhances scanning for language and OS-specific components. Both StackRox Scanner and Scanner V4 are recommended for full coverage. Scanner V4 is not enabled by default and is mainly required for special scenarios (e.g., external registries, registry mirroring).

> **Note:**
> Scanner V4 only considers Red Hat product vulnerabilities from 2014 onward.

### Enabling Scanner V4

- **Central:** Set `scannerV4.scannerComponent: Enabled` in the Operator UI or Central CR YAML.
- **Secured Clusters:** Set `scannerV4.scannerComponent: AutoSense` in the Operator UI or SecuredCluster CR YAML.
- **Helm:** Use `--set scannerV4.disable=false` during installation.

> **Important:**
> StackRox Scanner must remain enabled for RHCOS, platform, and Kubernetes vulnerabilities.

## Scanner Workflows

**StackRox Scanner:**
1. Central submits scan requests.
2. Scanner pulls image layers, identifies packages, and compares them with vulnerability lists.
3. Results are sent back to Central.

**Scanner V4:**
1. Central requests Scanner V4 Indexer to analyze images.
2. Indexer pulls metadata and downloads layers.
3. Indexer produces an index report.
4. Matcher matches images to vulnerabilities and generates reports.

## Common Scanner Warning Messages

| Message | Description |
|---------|-------------|
| Unable to retrieve the OS CVE data, only Language CVE data is available | Base OS not supported; no OS-level CVEs. |
| Stale OS CVE data | OS is end-of-life; data may be outdated. |
| Failed to get the base OS information | Scanner could not determine the base OS. |
| Failed to retrieve metadata from the registry | Registry unreachable or authentication failed. |
| Image out of scope for Red Hat Vulnerability Scanner Certification | Image is too old for certification. |

> **Tip:**
> Use base images newer than June 2020 for best results.

## Supported Linux Distributions

| Distribution | Version |
|--------------|---------|
| Alpine Linux | `alpine:3.2`–`alpine:3.21`, `alpine:edge` |
| Amazon Linux | `amzn:2018.03`, `amzn:2`, `amzn:2023` |
| CentOS | `centos:6`, `centos:7`, `centos:8` |
| Debian | `debian:11`, `debian:12`, `debian:unstable`, [`Distroless`](https://github.com/GoogleContainerTools/distroless) |
| Oracle Linux | `ol:5`–`ol:9` |
| Photon OS | `photon:1.0`–`photon:3.0` |
| RHEL | `rhel:6`–`rhel:9` |
| SUSE | `sles:11`–`sles:15`, `opensuse-leap:15.5`, `opensuse-leap:15.6` |
| Ubuntu | `ubuntu:14.04`–`ubuntu:24.10` |

> **Note:**
> Some older Debian/Ubuntu versions are not updated by the vendor. Fedora is not supported for OS CVEs.

## Supported Package Formats

| Package Format | Package Managers |
|---------------|-----------------|
| apk | apk |
| dpkg | apt; dpkg |
| rpm | dnf; microdnf; rpm; yum |

## Supported Programming Languages

| Language | Package Format |
|----------|---------------|
| Go | Binaries (analyzes stdlib and, if present, `go.mod` dependencies) |
| Java | JAR; WAR; EAR; JPI; HPI |
| JavaScript | package.json |
| Python | egg; wheel |
| Ruby | gem |

## Supported Container Image Layer Formats

| Format | StackRox Scanner | Scanner V4 |
|--------|------------------|------------|
| No compression | Yes | Yes |
| bzip2 | Yes | Yes |
| gzip | Yes | Yes |
| xz | Yes | No |
| zstd | No | Yes |

> **Note:**
> StackRox Scanner supports .NET Core and ASP.NET Core; Scanner V4 does not.

## Delegated Image Scanning

Alauda Container Security supports delegated scanning for images from registry mirrors using custom resources like ICSP, IDMS, and ITMS. Scanner-slim can index images in secured clusters and send results to Central for vulnerability matching. Delegation can be configured for all, none, or specific registries.

**Prerequisites:**
- Scanner installed in the secured cluster.

**Steps:**
1. In the portal, go to **Platform Configuration > Clusters**.
2. Click **Delegated scanning**.
3. Configure delegation scope and default cluster.
4. Optionally, add source registry and destination cluster pairs.
5. Click **Save**.

Scanner-slim must be present and healthy in the secured cluster. For more, see the [Operator install guide](https://docs.redhat.com/en/documentation/alauda_container_security_for_kubernetes/4.7/html-single/installing/#installing-sc-operator).

## Image Scanning and Watch List

Alauda Container Security scans all active images every 4 hours. You can also enable automatic scanning of inactive images (from version 3.0.57) via the **Watch** setting.

**Steps:**
1. In the portal, go to **Vulnerability Management > Results**.
2. Click **More Views > Inactive images**.
3. Click **Manage watched images** and add or remove images as needed.

> **Note:**
> Data for removed images is retained for the configured period in **System Configuration**.

## Vulnerability Data Updates

Central fetches vulnerability definitions every 5 minutes from `https://definitions.stackrox.io` and refreshes every 3 hours. You can adjust the update interval with:

```bash
oc -n stackrox set env deploy/central ROX_SCANNER_VULN_UPDATE_INTERVAL=<value>
```
(Use `kubectl` for Kubernetes.)

Both scanners use data from Central. For more, see "Vulnerability sources" in the architecture docs.

## CVSS Scoring

Alauda Container Security displays a single CVSS base score per vulnerability:
- Shows CVSS v3 if available (requires StackRox Scanner ≥1.3.5 or Scanner V4)
- Otherwise, shows CVSS v2

API responses may include both v2 and v3 scores if available. For Red Hat Security Advisories (RHSA), the highest CVSS among related CVEs is shown.

## Disabling Language-Specific Scanning

To disable language-specific vulnerability scanning:

```bash
oc -n stackrox set env deploy/scanner ROX_LANGUAGE_VULNS=false
```
(Use `kubectl` for Kubernetes. For versions ≤3.0.47, use `LANGUAGE_VULNS`.)

- [Red Hat CVE Database](https://access.redhat.com/security/cve)
