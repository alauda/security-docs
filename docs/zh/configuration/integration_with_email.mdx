---
weight: 15
sourceSHA: 9fde7de3b6fa4908c8acc6d5cce5b0e1f284d096a18b90f914b3670d090ce29a
---

# 与电子邮件的集成

Alauda 容器安全支持通过电子邮件发送通知。您可以配置现有的电子邮件提供商或使用内置的电子邮件通知器来发送告警。通知可以发送到默认收件人，或通过在您的部署或命名空间中使用注释动态确定。

:::info
端口 `25` 默认被阻止。请配置您的邮件服务器使用端口 `587` 或 `465` 发送电子邮件通知。
:::

## 配置电子邮件集成

按照以下步骤设置电子邮件通知：

### 添加新的电子邮件集成

1. 导航到 **平台配置** > **集成**。
2. 在 **通知器集成** 下，选择 **电子邮件**。
3. 点击 **新建集成**。
4. 在 **集成名称** 字段中输入您的集成名称。
5. 在 **电子邮件服务器** 字段中，提供您的邮件服务器地址，包括 FQDN 和端口（例如，`smtp.example.com:465`）。
6. （可选）要使用未认证的 SMTP，请选择 **启用未认证的 SMTP**。\
   :::warning
   这不安全，除非内部服务器需要，否则不推荐使用。
   :::
7. 输入用于身份验证的服务账户的用户名和密码。
8. （可选）在 **发件人** 字段中指定 `FROM` 头的显示名称（例如，`安全警报`）。
9. 在 **发件人** 字段中输入发件人的电子邮件地址。
10. 在 **默认收件人** 字段中指定默认收件人的电子邮件地址。

### 使用注释动态确定收件人（可选）

您可以使用注释动态确定电子邮件通知的收件人：

1. 在 **收件人注释键** 字段中，输入注释键（例如，`email`）。

2. 在您的部署或命名空间 YAML 文件中添加注释：

   ```yaml
   metadata:
     annotations:
       email: <recipient_email@example.com>
   ```

3. Alauda 容器安全将向注释中指定的电子邮件发送告警。如果未找到注释，则告警将发送到默认收件人。

**收件人解析规则：**

- 如果部署具有注释键，则其值将覆盖默认收件人。
- 如果命名空间具有注释键，则其值将覆盖默认收件人。
- 如果两者都不存在，则使用默认收件人。

### TLS 和 StartTLS 设置

- （可选）要在没有 TLS 的情况下发送电子邮件，请选择 **禁用 TLS 证书验证（不安全）**。\
  :::info
  建议使用 TLS 以确保安全的电子邮件传递。
  :::
- （可选）要使用 StartTLS，请从 **使用 STARTTLS** 下拉菜单中选择 **登录** 或 **明文**。
  - **登录：** 凭证以 base64 编码字符串形式发送。
  - **明文：** 凭证以明文形式发送。

:::warning
使用 StartTLS 时，凭证在加密建立之前以明文形式传输。
:::

## 为策略启用电子邮件通知

1. 在 Alauda 容器安全门户中，转到 **平台配置** > **策略管理**。
2. 选择一个或多个策略以启用通知。
3. 在 **批量操作** 下，选择 **启用通知**。
4. 在 **启用通知** 窗口中，选择 **电子邮件** 通知器。
5. 点击 **启用**。

:::info

- 通知为自愿选择。为每个策略分配通知器以接收告警。
- 每个告警仅发送一次。对于以下情况会生成新的告警：
  - 部署中的第一次策略违规。
  - 在上一个告警解决后，运行时阶段的策略违规。

:::

---

通过遵循这些步骤，您可以确保 Alauda 容器安全将重要的安全事件通知给您的容器平台中的相关人员。
